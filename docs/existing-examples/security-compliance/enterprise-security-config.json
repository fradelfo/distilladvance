{
  "name": "Enterprise Security Configuration",
  "description": "Comprehensive security configuration for enterprise environments with strict controls and compliance requirements",
  "version": "1.0.0",
  "security_level": "high",
  "compliance_frameworks": ["SOC2", "GDPR", "HIPAA", "ISO27001"],

  "authentication": {
    "require_authentication": true,
    "session_timeout": 3600,
    "max_failed_attempts": 3,
    "lockout_duration": 1800,
    "require_mfa": true,
    "mfa_methods": ["totp", "hardware_token", "biometric"],
    "password_policy": {
      "min_length": 14,
      "require_uppercase": true,
      "require_lowercase": true,
      "require_numbers": true,
      "require_special_chars": true,
      "password_history": 12,
      "max_age_days": 90
    },
    "session_management": {
      "secure_cookies": true,
      "httponly_cookies": true,
      "samesite": "strict",
      "rotate_session_id": true,
      "concurrent_sessions": 1
    }
  },

  "authorization": {
    "rbac_enabled": true,
    "default_deny": true,
    "privilege_escalation_detection": true,
    "access_review_frequency": "quarterly",
    "role_definitions": {
      "junior_developer": {
        "permissions": {
          "read": ["src/**/*.js", "src/**/*.ts", "docs/**/*", "tests/**/*"],
          "edit": ["src/components/**/*", "src/utils/**/*", "tests/**/*"],
          "execute": ["npm test", "npm run lint", "npm run build"],
          "create": ["tests/**/*", "docs/**/*"]
        },
        "restrictions": {
          "deny_paths": [".env*", "secrets/**/*", "config/production*", "infrastructure/**/*"],
          "deny_commands": ["rm -rf", "sudo", "su", "chmod 777", "docker run", "kubectl"],
          "time_restrictions": "09:00-17:00",
          "ip_restrictions": ["10.0.0.0/8", "192.168.0.0/16"],
          "max_session_duration": 7200
        },
        "monitoring": {
          "log_all_actions": true,
          "alert_on_violations": true,
          "require_justification": true
        }
      },
      "senior_developer": {
        "permissions": {
          "read": ["**/*"],
          "edit": ["src/**/*", "tests/**/*", "docs/**/*", "config/development*"],
          "execute": ["npm *", "git *", "docker build", "kubectl get"],
          "create": ["src/**/*", "tests/**/*", "docs/**/*", "migrations/**/*"]
        },
        "restrictions": {
          "deny_paths": [".env.production", "secrets/production*", "config/production.secret*"],
          "deny_commands": ["sudo rm -rf /", "format c:", "dd if=", ":(){ :|:& };:"],
          "require_approval": ["config/production*", "infrastructure/**/*"],
          "time_restrictions": "06:00-22:00",
          "max_session_duration": 14400
        },
        "monitoring": {
          "log_all_actions": true,
          "alert_on_sensitive_access": true,
          "require_justification_sensitive": true
        }
      },
      "tech_lead": {
        "permissions": {
          "read": ["**/*"],
          "edit": ["**/*"],
          "execute": ["**/*"],
          "create": ["**/*"],
          "delete": ["tests/**/*", "docs/**/*", "src/**/*"],
          "admin": ["user_management", "role_assignment", "security_config_read"]
        },
        "restrictions": {
          "deny_paths": ["secrets/master*", ".claude/settings.production.json"],
          "require_approval": ["infrastructure/production*", "security/**/*"],
          "require_dual_control": ["user_deletion", "role_modification", "security_changes"],
          "max_session_duration": 28800
        },
        "monitoring": {
          "log_all_actions": true,
          "alert_on_admin_actions": true,
          "require_justification_always": true,
          "video_recording": false
        }
      },
      "security_admin": {
        "permissions": {
          "read": ["**/*"],
          "admin": ["security_config", "audit_logs", "user_management", "role_management"],
          "security": ["vulnerability_scan", "penetration_test", "incident_response"]
        },
        "restrictions": {
          "deny_paths": ["src/**/*", "development/**/*"],
          "require_dual_control": ["security_policy_changes", "audit_log_deletion"],
          "require_approval": ["emergency_access", "compliance_override"],
          "max_session_duration": 14400,
          "require_secure_workstation": true
        },
        "monitoring": {
          "log_all_actions": true,
          "alert_on_all_actions": true,
          "require_justification_always": true,
          "video_recording": true,
          "real_time_monitoring": true
        }
      }
    }
  },

  "data_governance": {
    "data_classification": {
      "enabled": true,
      "classifications": {
        "public": {
          "label": "Public",
          "color": "green",
          "restrictions": [],
          "retention_period": "indefinite"
        },
        "internal": {
          "label": "Internal Use Only",
          "color": "yellow",
          "restrictions": ["employee_access_only"],
          "retention_period": "7_years"
        },
        "confidential": {
          "label": "Confidential",
          "color": "orange",
          "restrictions": ["authorized_personnel_only", "encryption_required"],
          "retention_period": "7_years"
        },
        "restricted": {
          "label": "Restricted",
          "color": "red",
          "restrictions": ["explicit_authorization", "encryption_required", "audit_all_access"],
          "retention_period": "10_years"
        }
      },
      "auto_classification": {
        "enabled": true,
        "patterns": {
          "ssn": "\\b\\d{3}-?\\d{2}-?\\d{4}\\b",
          "credit_card": "\\b\\d{4}[- ]?\\d{4}[- ]?\\d{4}[- ]?\\d{4}\\b",
          "email": "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}",
          "phone": "\\b\\d{3}[.-]?\\d{3}[.-]?\\d{4}\\b",
          "api_key": "(?i)(api[_-]?key|apikey)[\"']?\\s*[:=]\\s*[\"']?[a-zA-Z0-9]{20,}",
          "password": "(?i)(password|pwd|pass)[\"']?\\s*[:=]\\s*[\"']?\\S+",
          "jwt_token": "eyJ[a-zA-Z0-9_-]*\\.[a-zA-Z0-9_-]*\\.[a-zA-Z0-9_-]*"
        },
        "classification_rules": {
          "ssn": "restricted",
          "credit_card": "restricted",
          "api_key": "confidential",
          "password": "confidential",
          "jwt_token": "confidential",
          "email": "internal",
          "phone": "internal"
        }
      }
    },

    "data_loss_prevention": {
      "enabled": true,
      "block_sensitive_data_egress": true,
      "alert_on_sensitive_access": true,
      "quarantine_violations": true,
      "notification_settings": {
        "immediate_alerts": ["restricted_data_access", "policy_violation"],
        "daily_summary": ["internal_data_access", "classification_changes"],
        "weekly_report": ["access_patterns", "trend_analysis"]
      }
    },

    "encryption": {
      "encryption_at_rest": {
        "enabled": true,
        "algorithm": "AES-256",
        "key_management": "external_hsm",
        "key_rotation_frequency": "quarterly"
      },
      "encryption_in_transit": {
        "enabled": true,
        "min_tls_version": "1.3",
        "cipher_suites": ["TLS_AES_256_GCM_SHA384", "TLS_CHACHA20_POLY1305_SHA256"],
        "certificate_validation": "strict",
        "hsts_enabled": true
      },
      "field_level_encryption": {
        "enabled": true,
        "encrypted_fields": ["ssn", "credit_card", "bank_account", "password_hash"],
        "encryption_method": "envelope_encryption"
      }
    }
  },

  "audit_logging": {
    "enabled": true,
    "log_level": "comprehensive",
    "retention_period": "7_years",
    "tamper_protection": true,
    "real_time_monitoring": true,

    "events_to_log": {
      "authentication": ["login", "logout", "failed_attempts", "password_changes", "mfa_events"],
      "authorization": ["access_granted", "access_denied", "privilege_escalation", "role_changes"],
      "data_access": ["file_read", "file_write", "file_delete", "database_query", "api_calls"],
      "system_events": ["configuration_changes", "software_updates", "service_restarts"],
      "security_events": ["vulnerability_scans", "incident_response", "policy_violations"]
    },

    "log_format": {
      "timestamp": "ISO_8601_UTC",
      "user_id": "required",
      "session_id": "required",
      "source_ip": "required",
      "user_agent": "required",
      "action": "required",
      "resource": "required",
      "result": "required",
      "risk_score": "calculated",
      "classification": "auto_detected",
      "justification": "when_required"
    },

    "log_forwarding": {
      "enabled": true,
      "destinations": ["siem", "log_analytics", "compliance_archive"],
      "encryption": true,
      "integrity_verification": true,
      "backup_locations": ["primary_datacenter", "disaster_recovery_site"]
    },

    "alerting": {
      "real_time_alerts": {
        "multiple_failed_logins": {
          "threshold": 5,
          "time_window": "5_minutes",
          "severity": "high"
        },
        "privileged_access": {
          "roles": ["security_admin", "tech_lead"],
          "severity": "medium"
        },
        "off_hours_access": {
          "time_range": "22:00-06:00",
          "severity": "medium"
        },
        "sensitive_data_access": {
          "classifications": ["restricted", "confidential"],
          "severity": "high"
        },
        "configuration_changes": {
          "paths": ["security/**/*", ".claude/settings*"],
          "severity": "critical"
        }
      }
    }
  },

  "network_security": {
    "firewall_rules": {
      "default_policy": "deny",
      "allowed_outbound": [
        "https://*.anthropic.com",
        "https://api.anthropic.com",
        "https://*.github.com",
        "https://registry.npmjs.org"
      ],
      "blocked_outbound": [
        "*://*.suspicious-domain.com",
        "ftp://*",
        "telnet://*"
      ],
      "allowed_inbound": [
        "22/tcp from 10.0.0.0/8",
        "443/tcp from 0.0.0.0/0",
        "80/tcp from 0.0.0.0/0"
      ]
    },

    "intrusion_detection": {
      "enabled": true,
      "mode": "active_blocking",
      "signatures_updated": "daily",
      "behavioral_analysis": true,
      "ml_anomaly_detection": true
    },

    "vpn_requirements": {
      "required_for_remote_access": true,
      "allowed_protocols": ["WireGuard", "OpenVPN", "IPSec"],
      "certificate_authentication": true,
      "split_tunneling": false
    }
  },

  "incident_response": {
    "enabled": true,
    "automatic_containment": {
      "suspicious_activity": "isolate_session",
      "malware_detected": "quarantine_system",
      "data_breach_suspected": "freeze_accounts"
    },

    "notification_procedures": {
      "security_team": {
        "immediate": ["critical_incidents", "data_breaches"],
        "within_1_hour": ["high_severity_incidents"],
        "daily_summary": ["all_incidents"]
      },
      "management": {
        "immediate": ["critical_incidents", "regulatory_violations"],
        "weekly_summary": ["incident_trends", "security_metrics"]
      },
      "regulatory": {
        "within_72_hours": ["gdpr_breaches", "hipaa_violations"],
        "within_30_days": ["sox_compliance_issues"]
      }
    },

    "response_procedures": {
      "identification": {
        "max_detection_time": "15_minutes",
        "automated_triage": true,
        "escalation_matrix": "role_based"
      },
      "containment": {
        "max_containment_time": "1_hour",
        "isolation_procedures": "automated",
        "evidence_preservation": "mandatory"
      },
      "eradication": {
        "root_cause_analysis": "required",
        "system_hardening": "mandatory",
        "vulnerability_patching": "priority"
      },
      "recovery": {
        "staged_restoration": true,
        "monitoring_enhanced": true,
        "business_continuity": "maintained"
      }
    }
  },

  "vulnerability_management": {
    "scanning_frequency": "daily",
    "scan_types": ["dependency_check", "static_analysis", "dynamic_analysis", "container_scan"],
    "vulnerability_databases": ["NVD", "OWASP", "vendor_advisories"],

    "remediation_sla": {
      "critical": "24_hours",
      "high": "7_days",
      "medium": "30_days",
      "low": "90_days"
    },

    "patch_management": {
      "automatic_security_patches": true,
      "testing_required": true,
      "rollback_procedures": "documented",
      "emergency_patching": "within_4_hours"
    }
  },

  "backup_and_recovery": {
    "backup_frequency": "continuous",
    "backup_retention": "7_years",
    "backup_encryption": true,
    "offsite_storage": true,
    "backup_testing": "monthly",

    "recovery_objectives": {
      "rto": "4_hours",
      "rpo": "15_minutes",
      "data_integrity_verification": "mandatory"
    },

    "disaster_recovery": {
      "hot_site_available": true,
      "automatic_failover": true,
      "regular_dr_testing": "quarterly",
      "business_continuity_plan": "documented"
    }
  },

  "compliance_monitoring": {
    "frameworks": {
      "soc2": {
        "enabled": true,
        "audit_frequency": "annual",
        "controls_testing": "quarterly",
        "automated_evidence_collection": true
      },
      "gdpr": {
        "enabled": true,
        "privacy_impact_assessments": "mandatory",
        "data_subject_rights": "automated",
        "breach_notification": "automated"
      },
      "hipaa": {
        "enabled": true,
        "business_associate_agreements": "required",
        "minimum_necessary_standard": "enforced",
        "audit_logs": "comprehensive"
      },
      "iso27001": {
        "enabled": true,
        "risk_assessments": "annual",
        "control_effectiveness": "quarterly",
        "management_reviews": "quarterly"
      }
    },

    "automated_compliance_checks": {
      "daily": ["access_reviews", "configuration_drift", "policy_violations"],
      "weekly": ["vulnerability_assessments", "patch_compliance"],
      "monthly": ["audit_log_reviews", "incident_analysis"],
      "quarterly": ["risk_assessments", "control_testing"]
    }
  },

  "training_and_awareness": {
    "required_training": {
      "security_awareness": "annual",
      "phishing_simulation": "monthly",
      "incident_response": "semi_annual",
      "compliance_training": "annual"
    },

    "training_tracking": {
      "completion_monitoring": true,
      "certification_required": true,
      "remedial_training": "automatic",
      "effectiveness_testing": true
    }
  },

  "third_party_risk_management": {
    "vendor_assessments": {
      "security_questionnaires": "mandatory",
      "penetration_testing": "required_for_critical",
      "compliance_certifications": "verified",
      "ongoing_monitoring": "continuous"
    },

    "contract_requirements": {
      "data_protection_clauses": "mandatory",
      "incident_notification": "24_hours",
      "audit_rights": "reserved",
      "liability_coverage": "adequate"
    }
  }
}